\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager}{\section{D\+M\+A\textbackslash{}Friends\textbackslash{}Classes\textbackslash{}Activity\+Manager Class Reference}
\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager}\index{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager@{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager}}
}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a59854358f0903314c27c9add5d151221}{register\+Activity} (\$class\+Name, \$code=null, \$plugin=null)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_ad340ffbbfee36d2253adcd61af8f98c4}{list\+Activities} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aff2ab3684ac9cc2714fd1d7957890584}{resolve} (\$name)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_abc447da5d00e01596fbfb3758c36b3de}{get\+Config} (\$alias)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a9d4d128c4b663b4a80dec5994e3af001}{get\+Form\+Default\+Values} (\$model)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aab92d7f0071021fdfef61d81ccc4224e}{save\+Data} (\$model, \$values)
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a6cede9fbdff5ca57057044445f08773e}{load\+Activities} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7e70e998e7e5fa750f02d8249d11f816}{load\+Activity} (\$alias)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a8cadb8848f604623c0697bd12612c47c}{{\bfseries \$callbacks} = \mbox{[}$\,$\mbox{]}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a8cadb8848f604623c0697bd12612c47c}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7256bfe22c687cadeb4283f87156f811}{{\bfseries \$code\+Map}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7256bfe22c687cadeb4283f87156f811}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_af13b2bd6d9a49fe21f89b98df06e09b4}{{\bfseries \$class\+Map}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_af13b2bd6d9a49fe21f89b98df06e09b4}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a1158b100754d3c79869279d9714a0ea2}{{\bfseries \$plugin\+Map}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a1158b100754d3c79869279d9714a0ea2}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a38859bff70496b4a982f8231e7eba5e0}{{\bfseries \$details\+Cache}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a38859bff70496b4a982f8231e7eba5e0}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aa2b78ca57a517b261da6f579d16c3f94}{{\bfseries \$activity\+Type}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aa2b78ca57a517b261da6f579d16c3f94}

\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_abc447da5d00e01596fbfb3758c36b3de}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!get\+Config@{get\+Config}}
\index{get\+Config@{get\+Config}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{get\+Config}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::get\+Config (
\begin{DoxyParamCaption}
\item[{}]{\$alias}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_abc447da5d00e01596fbfb3758c36b3de}
Return field configuration for an Activity Type


\begin{DoxyParams}{Parameters}
{\em Activity} & Alias\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
an array representing the field configuration 
\end{DoxyReturn}

\begin{DoxyCode}
167     \{
168         $this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7e70e998e7e5fa750f02d8249d11f816}{loadActivity}($alias);
169         
170         $formConfig = $this->activityType->getConfig();
171 
172         \textcolor{keywordflow}{return} $this->makeConfig($formConfig);
173     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a9d4d128c4b663b4a80dec5994e3af001}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!get\+Form\+Default\+Values@{get\+Form\+Default\+Values}}
\index{get\+Form\+Default\+Values@{get\+Form\+Default\+Values}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{get\+Form\+Default\+Values}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::get\+Form\+Default\+Values (
\begin{DoxyParamCaption}
\item[{}]{\$model}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a9d4d128c4b663b4a80dec5994e3af001}
An alias to access the get\+Form\+Default\+Values method of the called activity type


\begin{DoxyParams}[1]{Parameters}
object & {\em \$model} & an activity model\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array An array of default form values 
\end{DoxyReturn}

\begin{DoxyCode}
185     \{
186         \textcolor{keywordflow}{if} (!$this->activityType)
187                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} SystemException(Lang::get(\textcolor{stringliteral}{'dma.friends::lang.exceptions.activityTypeNotInitiated'}
      ));
188 
189         \textcolor{keywordflow}{return} $this->activityType->getFormDefaultValues($model);
190     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_ad340ffbbfee36d2253adcd61af8f98c4}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!list\+Activities@{list\+Activities}}
\index{list\+Activities@{list\+Activities}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{list\+Activities}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::list\+Activities (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_ad340ffbbfee36d2253adcd61af8f98c4}
Returns a list of registered activities. \begin{DoxyReturn}{Returns}
array Array keys are codes, values are class names. 
\end{DoxyReturn}

\begin{DoxyCode}
126     \{   
127         \textcolor{keywordflow}{if} ($this->codeMap === null) \{
128             $this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a6cede9fbdff5ca57057044445f08773e}{loadActivities}();
129         \}   
130 
131         \textcolor{keywordflow}{return} $this->codeMap;
132     \} 
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a6cede9fbdff5ca57057044445f08773e}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!load\+Activities@{load\+Activities}}
\index{load\+Activities@{load\+Activities}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{load\+Activities}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::load\+Activities (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a6cede9fbdff5ca57057044445f08773e}
Load the available activities that are defined by plugins 
\begin{DoxyCode}
59     \{   
60         \textcolor{comment}{/*  }
61 \textcolor{comment}{         * Load module activities}
62 \textcolor{comment}{         */}
63         \textcolor{keywordflow}{foreach} ($this->callbacks as $callback) \{
64             $callback($this);
65         \}   
66 
67         \textcolor{comment}{/*  }
68 \textcolor{comment}{         * Load plugin activities}
69 \textcolor{comment}{         */}
70         $pluginManager = PluginManager::instance();
71         $plugins = $pluginManager->getPlugins();
72 
73         \textcolor{keywordflow}{foreach} ($plugins as $plugin) \{
74             \textcolor{keywordflow}{if} (method\_exists($plugin, \textcolor{stringliteral}{'registerFriendsActivities'})) \{
75                 $activities = $plugin->registerFriendsActivities();
76                 \textcolor{keywordflow}{if} (!is\_array($activities)) \{
77                     \textcolor{keywordflow}{continue};
78                 \}   
79 
80                 \textcolor{keywordflow}{foreach} ($activities as $className => $code) \{
81                     $this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a59854358f0903314c27c9add5d151221}{registerActivity}($className, $code, $plugin);
82                 \}   
83             \} 
84         \}   
85     \}  
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7e70e998e7e5fa750f02d8249d11f816}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!load\+Activity@{load\+Activity}}
\index{load\+Activity@{load\+Activity}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{load\+Activity}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::load\+Activity (
\begin{DoxyParamCaption}
\item[{}]{\$alias}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7e70e998e7e5fa750f02d8249d11f816}
Instantiate an instance of the choosen activity type by class alias


\begin{DoxyParams}[1]{Parameters}
string & {\em \$alias} & An activity type class alias \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
216     \{
217         \textcolor{keywordflow}{if} (!$alias) \textcolor{keywordflow}{return};
218 
219         \textcolor{keywordflow}{if} (!$this->activityType) \{
220             $className = $this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aff2ab3684ac9cc2714fd1d7957890584}{resolve}($alias);
221 
222             \textcolor{keywordflow}{if} (!$className)
223                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} SystemException(Lang::get(\textcolor{stringliteral}{'dma.friends::lang.exceptions.missingActivityClass'}, [\textcolor{stringliteral}{'
      class'} => $alias]));
224 
225             $this->activityType = \textcolor{keyword}{new} $className;
226         \}
227     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a59854358f0903314c27c9add5d151221}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!register\+Activity@{register\+Activity}}
\index{register\+Activity@{register\+Activity}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{register\+Activity}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::register\+Activity (
\begin{DoxyParamCaption}
\item[{}]{\$class\+Name, }
\item[{}]{\$code = {\ttfamily null}, }
\item[{}]{\$plugin = {\ttfamily null}}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a59854358f0903314c27c9add5d151221}
Registers a single activity.


\begin{DoxyParams}[1]{Parameters}
string & {\em \$class\+Name} & the name of the class to register\\
\hline
string & {\em \$code} & An id for the Activity to register\\
\hline
string & {\em \$plugin} & the name of the plugin \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
100     \{   
101         \textcolor{keywordflow}{if} (!$this->classMap) \{
102             $this->classMap = []; 
103         \}   
104 
105         \textcolor{keywordflow}{if} (!$this->codeMap) \{
106             $this->codeMap = []; 
107         \}   
108 
109         \textcolor{keywordflow}{if} (!$code) \{
110             $code = Str::getClassId($className);
111         \}   
112 
113         $className = Str::normalizeClassName($className);
114         $this->codeMap[$code] = $className;
115         $this->classMap[$className] = $code;
116         \textcolor{keywordflow}{if} ($plugin !== null) \{
117             $this->pluginMap[$className] = $plugin;
118         \}   
119     \} 
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aff2ab3684ac9cc2714fd1d7957890584}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!resolve@{resolve}}
\index{resolve@{resolve}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{resolve}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::resolve (
\begin{DoxyParamCaption}
\item[{}]{\$name}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aff2ab3684ac9cc2714fd1d7957890584}
Returns a class name from a component code Normalizes a class name or converts an code to it's class name.


\begin{DoxyParams}[1]{Parameters}
string & {\em \$name} & The alias of the class being resolved\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string The class name resolved, or null. 
\end{DoxyReturn}

\begin{DoxyCode}
144     \{   
145         $codes = $this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_ad340ffbbfee36d2253adcd61af8f98c4}{listActivities}();
146 
147         \textcolor{keywordflow}{if} (isset($codes[$name])) \{
148             \textcolor{keywordflow}{return} $codes[$name];
149         \}   
150 
151         $name = Str::normalizeClassName($name);
152         \textcolor{keywordflow}{if} (isset($this->classMap[$name])) \{
153             \textcolor{keywordflow}{return} $name;
154         \}   
155 
156         \textcolor{keywordflow}{return} null;
157     \} 
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aab92d7f0071021fdfef61d81ccc4224e}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}!save\+Data@{save\+Data}}
\index{save\+Data@{save\+Data}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Activity\+Manager}}
\subsubsection[{save\+Data}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Activity\+Manager\+::save\+Data (
\begin{DoxyParamCaption}
\item[{}]{\$model, }
\item[{}]{\$values}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aab92d7f0071021fdfef61d81ccc4224e}
An alias to access the \hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_aab92d7f0071021fdfef61d81ccc4224e}{save\+Data()} method of the called activity type


\begin{DoxyParams}[1]{Parameters}
object & {\em \$model} & An activity model\\
\hline
array & {\em \$values} & An array of values to be saved \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
202     \{
203         \textcolor{keywordflow}{if} (!$this->activityType)
204             $this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1ActivityManager_a7e70e998e7e5fa750f02d8249d11f816}{loadActivity}($values[\textcolor{stringliteral}{'activity\_type'}]);
205 
206         $this->activityType->saveData($model, $values);
207     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
classes/Activity\+Manager.\+php\end{DoxyCompactItemize}
