\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager}{}\section{D\+M\+A\textbackslash{}Friends\textbackslash{}Components\textbackslash{}Group\+Manager Class Reference}
\label{classDMA_1_1Friends_1_1Components_1_1GroupManager}\index{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager@{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager}}
Inheritance diagram for D\+M\+A\textbackslash{}Friends\textbackslash{}Components\textbackslash{}Group\+Manager\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{d9/d20/classDMA_1_1Friends_1_1Components_1_1GroupManager}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a060db8751d55b0068666951f864263b3}{}{\bfseries component\+Details} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a060db8751d55b0068666951f864263b3}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a4837e1df34761838844262791e1c1d6b}{}{\bfseries define\+Properties} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a4837e1df34761838844262791e1c1d6b}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_ad956ddad7b4f23cfc2111bbe97d40c77}{}{\bfseries on\+Run} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_ad956ddad7b4f23cfc2111bbe97d40c77}

\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_ab676c63165e8a5ac01b8c7e6630f187f}{on\+Submit} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_a1022b6c4b9d4a31cf1b41d15ba13ab1f}{on\+Create\+Group} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_a7cec31625dfe221d62d620a078883815}{on\+Cancel\+Group} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_ac0784d39e4fe94f792bec571cec1b202}{on\+Add\+Member} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_a66ab56b50c4bc943aad47bc5fdd33789}{on\+Remove\+Member} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_a852933111a787d927fc27d3f9465cd07}{on\+Go\+To\+Step} ()
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a0f7f7beaddfc56dc358a16414e86c81c}{}const {\bfseries S\+T\+E\+P\+\_\+\+G\+R\+O\+U\+P\+S} = \textquotesingle{}@groups-\/manager\textquotesingle{}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a0f7f7beaddfc56dc358a16414e86c81c}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_af8042daa037d008291e60d95f037707f}{}const {\bfseries S\+T\+E\+P\+\_\+\+M\+E\+M\+B\+E\+R\+S} = \textquotesingle{}@members-\/manager\textquotesingle{}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_af8042daa037d008291e60d95f037707f}

\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_abc2316e8087752f7e5530e10af5eb538}{get\+User} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_aeeeb6595d45ee64e0b9eb301d4135f8e}{get\+Groups} ()
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a4cecf633a22c676b337139f2e7359331}{}{\bfseries get\+Group} (\$id)\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a4cecf633a22c676b337139f2e7359331}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a3dffddcaf9693dbbc98eb3ddbd3759f3}{}{\bfseries get\+Login\+Attr} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a3dffddcaf9693dbbc98eb3ddbd3759f3}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_af28812279ffd208c69a67c2f941dd2e2}{}{\bfseries prepare\+Vars} (\$vars=\mbox{[}$\,$\mbox{]})\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_af28812279ffd208c69a67c2f941dd2e2}

\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_aeeeb6595d45ee64e0b9eb301d4135f8e}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!get\+Groups@{get\+Groups}}
\index{get\+Groups@{get\+Groups}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{get\+Groups}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::get\+Groups (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_aeeeb6595d45ee64e0b9eb301d4135f8e}
\begin{DoxyReturn}{Returns}
\hyperlink{namespaceDMA}{D\+M\+A} 
\end{DoxyReturn}

\begin{DoxyCode}
75     \{
76         \textcolor{keywordflow}{if}($user = $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_abc2316e8087752f7e5530e10af5eb538}{getUser}())\{
77             $groups = UserGroup::where(\textcolor{stringliteral}{'owner\_id'}, $user->getKey())
78                                 ->isActive()->get();
79             \textcolor{keywordflow}{return} $groups;   
80         \}
81         \textcolor{keywordflow}{return} [];
82     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_abc2316e8087752f7e5530e10af5eb538}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!get\+User@{get\+User}}
\index{get\+User@{get\+User}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{get\+User}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::get\+User (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_abc2316e8087752f7e5530e10af5eb538}
\begin{DoxyReturn}{Returns}
Rain\+Lab 
\end{DoxyReturn}

\begin{DoxyCode}
64     \{
65         \textcolor{keywordflow}{if}(is\_null($this->user))\{
66             $this->user = Auth::getUser();
67         \}
68         \textcolor{keywordflow}{return} $this->user;
69     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_ac0784d39e4fe94f792bec571cec1b202}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!on\+Add\+Member@{on\+Add\+Member}}
\index{on\+Add\+Member@{on\+Add\+Member}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{on\+Add\+Member}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::on\+Add\+Member (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_ac0784d39e4fe94f792bec571cec1b202}
Ajax handler for adding members 
\begin{DoxyCode}
236                                  \{
237         
238         \textcolor{comment}{// refresh current step}
239         $this->currentStep = self::STEP\_MEMBERS;
240         
241         \textcolor{keywordflow}{if} (($groupId = post(\textcolor{stringliteral}{'groupId'})) != \textcolor{stringliteral}{''})\{
242         
243             \textcolor{comment}{// Add to group}
244             $group = $this->getGroup($groupId);
245     
246             \textcolor{keywordflow}{if} (($username = post(\textcolor{stringliteral}{'username'})) != \textcolor{stringliteral}{''})\{
247                 $user = User::where($this->getLoginAttr(), \textcolor{charliteral}{'='}, $username)->first();
248                 \textcolor{keywordflow}{if} ($user)\{
249                     \(\backslash\)Log::info(\hyperlink{classDMA_1_1Friends_1_1Models_1_1UserGroup_a224d129818f1ab0831ddb054dff1f514}{UserGroup::getActiveMembershipsCount}(
      $user));
250                     \textcolor{keywordflow}{try}\{
251                         $added = $group->addUser($user);
252                         \textcolor{keywordflow}{if}(!$added)\{
253                             \textcolor{keywordflow}{if}($user->getKey() == $group->owner->getKey()) \{
254                                 $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.groups.ownerCanBeMember'});
255                                 Flash::error($message);
256                             \}
257                         \}
258                     \}\textcolor{keywordflow}{catch}(\(\backslash\)\hyperlink{namespaceException}{Exception} $e)\{
259                         Flash::error($e->getMessage());
260                     \}
261                 \}\textcolor{keywordflow}{else}\{
262                     $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.exceptions.userNotFound'});
263                     Flash::error($message);
264                 \}
265         
266             \}
267         
268             \textcolor{comment}{// Updated list of users and other vars}
269             $this->prepareVars($group);
270         \}
271     \}    
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a7cec31625dfe221d62d620a078883815}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!on\+Cancel\+Group@{on\+Cancel\+Group}}
\index{on\+Cancel\+Group@{on\+Cancel\+Group}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{on\+Cancel\+Group}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::on\+Cancel\+Group (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a7cec31625dfe221d62d620a078883815}
Ajax handler for closing groups 
\begin{DoxyCode}
210                                    \{
211         \textcolor{comment}{// refresh current step}
212         $this->currentStep = self::STEP\_GROUPS;
213         
214         \textcolor{keywordflow}{if} (($groupId = post(\textcolor{stringliteral}{'groupId'})) != \textcolor{stringliteral}{''})\{
215             \textcolor{keywordflow}{if}($group = UserGroup::find($groupId))\{
216                 \textcolor{comment}{// mark as inactive  group}
217                 $group->is\_active = \textcolor{keyword}{false};
218                 $group->save();
219     
220                 \textcolor{comment}{// Updated page variables}
221                 $this->prepareVars();
222                 
223                 $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.groups.groupCanceled'});
224                 Flash::info($message);
225                 
226             \}\textcolor{keywordflow}{else}\{
227                 $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.exceptions.groupNotFound'});
228                 Flash::error($message);
229             \}
230         \}
231     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a1022b6c4b9d4a31cf1b41d15ba13ab1f}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!on\+Create\+Group@{on\+Create\+Group}}
\index{on\+Create\+Group@{on\+Create\+Group}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{on\+Create\+Group}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::on\+Create\+Group (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a1022b6c4b9d4a31cf1b41d15ba13ab1f}
Ajax handler for creating groups 
\begin{DoxyCode}
188     \{
189         \textcolor{comment}{// refresh current step}
190         $this->currentStep = self::STEP\_GROUPS;
191         
192         \textcolor{keywordflow}{if}( $user = $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_abc2316e8087752f7e5530e10af5eb538}{getUser}() )\{
193             \textcolor{keywordflow}{if}( !empty( $name = post(\textcolor{stringliteral}{'name'})))\{
194                 \textcolor{keywordflow}{try}\{
195                     $group = \hyperlink{classDMA_1_1Friends_1_1Models_1_1UserGroup_aad51304db18c13520b9753e2380089bb}{UserGroup::createGroup}($user, $name);
196                 \}\textcolor{keywordflow}{catch}(\(\backslash\)\hyperlink{namespaceException}{Exception} $e)\{
197                     Flash::error($e->getMessage());
198                 \}
199             \}
200         \}
201         
202         \textcolor{comment}{// Updated list of grous and other vars}
203         $this->prepareVars();
204     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a852933111a787d927fc27d3f9465cd07}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!on\+Go\+To\+Step@{on\+Go\+To\+Step}}
\index{on\+Go\+To\+Step@{on\+Go\+To\+Step}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{on\+Go\+To\+Step}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::on\+Go\+To\+Step (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a852933111a787d927fc27d3f9465cd07}
Ajax handler to access membership group tools 
\begin{DoxyCode}
311                                 \{
312         \textcolor{keywordflow}{if} (($step = post(\textcolor{stringliteral}{'step'})) != \textcolor{stringliteral}{''})\{
313 
314             $this->currentStep    = $step;
315             $this->currentGroupId = post(\textcolor{stringliteral}{'groupId'});
316             
317             $this->prepareVars();
318 
319             \textcolor{keywordflow}{return} [
320                 \textcolor{stringliteral}{"#step"} => $this->renderPartial($step)
321             ];
322         \}
323     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_a66ab56b50c4bc943aad47bc5fdd33789}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!on\+Remove\+Member@{on\+Remove\+Member}}
\index{on\+Remove\+Member@{on\+Remove\+Member}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{on\+Remove\+Member}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::on\+Remove\+Member (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_a66ab56b50c4bc943aad47bc5fdd33789}
Ajax handler for removing members 
\begin{DoxyCode}
277                                     \{
278         \textcolor{comment}{// refresh current step}
279         $this->currentStep = self::STEP\_MEMBERS;
280         
281         \textcolor{keywordflow}{if} ( (($memberId = post(\textcolor{stringliteral}{'memberId'})) != \textcolor{stringliteral}{''}) &&
282              (($groupId  = post(\textcolor{stringliteral}{'groupId'}))  != \textcolor{stringliteral}{''}) ) \{
283                  
284             $user = User::find($memberId);
285             \textcolor{keywordflow}{if} ($user)\{
286                 \textcolor{keywordflow}{if}($group = $this->getGroup($groupId)) \{
287                     \textcolor{comment}{// remove from group}
288                     $group->removeUser($user);
289                     
290                     \textcolor{comment}{// Refresh current groupid}
291                     $this->currentGroupId = $groupId;
292                     
293                     \textcolor{comment}{// Updated list of users and other vars}
294                     $this->prepareVars();
295                     
296                     $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.groups.memberRemoved'});
297                     Flash::info($message);
298                 \}
299     
300             \}\textcolor{keywordflow}{else}\{
301                 $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.exceptions.userNotFound'});
302                 Flash::info($message);
303             \}
304         \}
305     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupManager_ab676c63165e8a5ac01b8c7e6630f187f}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}!on\+Submit@{on\+Submit}}
\index{on\+Submit@{on\+Submit}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Manager}}
\subsubsection[{on\+Submit}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Manager\+::on\+Submit (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupManager_ab676c63165e8a5ac01b8c7e6630f187f}
Common Ajax handler for forms using form\+\_\+ajax tag. 
\begin{DoxyCode}
167                               \{
168         \textcolor{keywordflow}{if}( !empty( $step = post(\textcolor{stringliteral}{'step'})))\{
169             $this->currentStep = $step;
170             
171             \textcolor{keywordflow}{switch} ($step)\{
172                 \textcolor{keywordflow}{case} self::STEP\_GROUPS:
173                     $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_a1022b6c4b9d4a31cf1b41d15ba13ab1f}{onCreateGroup}();
174                     \textcolor{keywordflow}{break};
175                 \textcolor{keywordflow}{case} self::STEP\_MEMBERS;
176                     $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupManager_ac0784d39e4fe94f792bec571cec1b202}{onAddMember}();
177                     \textcolor{keywordflow}{break};  
178             \}
179             
180         \}
181 
182     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
components/Group\+Manager.\+php\end{DoxyCompactItemize}
