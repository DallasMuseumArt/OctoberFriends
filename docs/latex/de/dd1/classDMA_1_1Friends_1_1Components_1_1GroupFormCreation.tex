\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation}{}\section{D\+M\+A\textbackslash{}Friends\textbackslash{}Components\textbackslash{}Group\+Form\+Creation Class Reference}
\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation}\index{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation@{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation}}
Inheritance diagram for D\+M\+A\textbackslash{}Friends\textbackslash{}Components\textbackslash{}Group\+Form\+Creation\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{de/dd1/classDMA_1_1Friends_1_1Components_1_1GroupFormCreation}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aff169c7950266d239c20fb1c42cbd95a}{}{\bfseries component\+Details} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aff169c7950266d239c20fb1c42cbd95a}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9cac8a6091971e1e88d5ca104986cc31}{}{\bfseries define\+Properties} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9cac8a6091971e1e88d5ca104986cc31}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a0bee9cf0dc3a8923818d402fa3532477}{}{\bfseries on\+Run} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a0bee9cf0dc3a8923818d402fa3532477}

\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9dd18b90b440803a9026ac790275f804}{on\+Add} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a7f4ddea881f2d0205ec7837c698e9490}{on\+Delete} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a8cc5c8e020c44811c6ccdd75c7375940}{on\+Search\+User} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aeddc641a6672000bcf9bcf89d338ee71}{on\+Create\+Group} ()
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9c69342fdb9b56087dfd6ab7165e5f74}{}{\bfseries get\+No\+User\+Redirect\+To\+Options} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9c69342fdb9b56087dfd6ab7165e5f74}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_adbe1bf34839afdab928e28f3043dc3b3}{}{\bfseries get\+New\+Group\+Redirect\+To\+Options} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_adbe1bf34839afdab928e28f3043dc3b3}

\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aaae6867daa8d36abbdff187b939d6715}{get\+User} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_afcc25a77b90e60e9f2f4e0deacaa2225}{get\+Group} ()
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a50c69e38289872cd98ca9a2c56c5dbaa}{}{\bfseries get\+Login\+Attr} ()\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a50c69e38289872cd98ca9a2c56c5dbaa}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a163b4d9b15b9cb6a269bc97e25fe1b0f}{}{\bfseries prepare\+Vars} (\$group=null, \$vars=\mbox{[}$\,$\mbox{]})\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a163b4d9b15b9cb6a269bc97e25fe1b0f}

\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_afcc25a77b90e60e9f2f4e0deacaa2225}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}!get\+Group@{get\+Group}}
\index{get\+Group@{get\+Group}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}}
\subsubsection[{get\+Group}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation\+::get\+Group (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_afcc25a77b90e60e9f2f4e0deacaa2225}
\begin{DoxyReturn}{Returns}
\hyperlink{namespaceDMA}{D\+M\+A} 
\end{DoxyReturn}

\begin{DoxyCode}
67     \{
68         $user = $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aaae6867daa8d36abbdff187b939d6715}{getUser}();
69         \textcolor{keywordflow}{if} (!is\_null($user))\{
70             \textcolor{keywordflow}{if} (!\hyperlink{classDMA_1_1Friends_1_1Models_1_1UserGroup_a98977f281ed3d9dc85220af0207c764d}{UserGroup::hasActiveMemberships}($user))\{
71                 \textcolor{comment}{//1. If user don't have an active membership create a group for it}
72                 $group = UserGroup::where(\textcolor{stringliteral}{'owner\_id'}, $user->getKey())
73                             ->where(\textcolor{stringliteral}{'is\_active'}, \textcolor{keyword}{true})
74                             ->first();
75                 
76                 $this->page[\textcolor{stringliteral}{'memberOfotherGroup'}] = \textcolor{keyword}{false};
77                 
78                 \textcolor{keywordflow}{return} $group;
79             \}\textcolor{keywordflow}{else}\{
80                 $this->page[\textcolor{stringliteral}{'memberOfotherGroup'}] = \textcolor{keyword}{true};
81             \}
82         \}
83     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aaae6867daa8d36abbdff187b939d6715}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}!get\+User@{get\+User}}
\index{get\+User@{get\+User}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}}
\subsubsection[{get\+User}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation\+::get\+User (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aaae6867daa8d36abbdff187b939d6715}
\begin{DoxyReturn}{Returns}
Rain\+Lab 
\end{DoxyReturn}

\begin{DoxyCode}
56     \{
57         \textcolor{keywordflow}{if}(is\_null($this->user))\{
58             $this->user = Auth::getUser();
59         \}
60         \textcolor{keywordflow}{return} $this->user;
61     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9dd18b90b440803a9026ac790275f804}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}!on\+Add@{on\+Add}}
\index{on\+Add@{on\+Add}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}}
\subsubsection[{on\+Add}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation\+::on\+Add (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a9dd18b90b440803a9026ac790275f804}
Ajax handler for adding members 
\begin{DoxyCode}
142                            \{
143         $users = post(\textcolor{stringliteral}{'users'}, []);
144         $maxUsers = Settings::get(\textcolor{stringliteral}{'maximum\_users\_per\_group'});
145         
146         \textcolor{keywordflow}{if} (count($users) >= $maxUsers)
147             \textcolor{comment}{//trans('dma.friends::lang.group.invalid\_activation\_code')}
148             \textcolor{keywordflow}{throw} new \(\backslash\)Exception(sprintf(\textcolor{stringliteral}{'Sorry only %s members per group are allowed.'}, $maxUsers));
149         
150         
151         \textcolor{comment}{// Add to group}
152         $group = $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_afcc25a77b90e60e9f2f4e0deacaa2225}{getGroup}();
153 
154         
155         \textcolor{keywordflow}{if} (($newUser = post(\textcolor{stringliteral}{'newUser'})) != \textcolor{stringliteral}{''})\{
156             $user = User::where($this->getLoginAttr(), \textcolor{charliteral}{'='}, $newUser)->first();
157             \textcolor{keywordflow}{if} ($user)\{
158                 $group->addUser($user);
159             \}\textcolor{keywordflow}{else}\{
160                 \textcolor{keywordflow}{throw} new \(\backslash\)Exception(\textcolor{stringliteral}{'User not found.'});
161             \}
162             
163         \}
164         
165         \textcolor{comment}{// Updated list of users and other vars}
166         $this->prepareVars($group);
167     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aeddc641a6672000bcf9bcf89d338ee71}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}!on\+Create\+Group@{on\+Create\+Group}}
\index{on\+Create\+Group@{on\+Create\+Group}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}}
\subsubsection[{on\+Create\+Group}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation\+::on\+Create\+Group (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aeddc641a6672000bcf9bcf89d338ee71}
Create a new group 
\begin{DoxyCode}
220     \{
221         \textcolor{keywordflow}{if} ($user = $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_aaae6867daa8d36abbdff187b939d6715}{getUser}())\{
222                       
223             $group = \textcolor{keyword}{new} UserGroup();
224             $group->owner = $user;
225             
226             $group->save();
227             
228             $goTo = $this->property(\textcolor{stringliteral}{'newGroupRedirectTo'});
229             $goTo = (trim($goTo) === \textcolor{stringliteral}{''} || !isset($goTo)) ? $\_SERVER[\textcolor{stringliteral}{'PHP\_SELF'}] : $goTo;
230             \textcolor{keywordflow}{return} Redirect::to($goTo);
231             
232         \}
233     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a7f4ddea881f2d0205ec7837c698e9490}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}!on\+Delete@{on\+Delete}}
\index{on\+Delete@{on\+Delete}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}}
\subsubsection[{on\+Delete}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation\+::on\+Delete (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a7f4ddea881f2d0205ec7837c698e9490}
Ajax handler for adding members 
\begin{DoxyCode}
172                               \{
173         \textcolor{keywordflow}{if} (($removeUser = post(\textcolor{stringliteral}{'removeUser'})) != \textcolor{stringliteral}{''})\{
174             $user = User::find($removeUser);
175             \textcolor{keywordflow}{if} ($user)\{
176                 \textcolor{comment}{// remove from group}
177                 $group = $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_afcc25a77b90e60e9f2f4e0deacaa2225}{getGroup}();
178                 $group->removeUser($user);
179     
180                 \textcolor{comment}{// Updated list of users and other vars}
181                 $this->prepareVars($group);
182     
183             \}\textcolor{keywordflow}{else}\{
184                 \textcolor{keywordflow}{throw} new \(\backslash\)Exception(\textcolor{stringliteral}{'User not found.'});
185             \}
186         \}
187     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a8cc5c8e020c44811c6ccdd75c7375940}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}!on\+Search\+User@{on\+Search\+User}}
\index{on\+Search\+User@{on\+Search\+User}!D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation@{D\+M\+A\+::\+Friends\+::\+Components\+::\+Group\+Form\+Creation}}
\subsubsection[{on\+Search\+User}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+Group\+Form\+Creation\+::on\+Search\+User (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1GroupFormCreation_a8cc5c8e020c44811c6ccdd75c7375940}
Ajax handler for searching users 
\begin{DoxyCode}
192                                   \{        
193         \textcolor{comment}{// Suggest exsiting members}
194         \textcolor{keywordflow}{if} (($search = post(\textcolor{stringliteral}{'newUser'})) != \textcolor{stringliteral}{''})\{
195    
196             $users = User::where($this->getLoginAttr(), \textcolor{stringliteral}{'LIKE'}, \textcolor{stringliteral}{"$search%"})
197                     ->orWhere(\textcolor{stringliteral}{'name'}, \textcolor{stringliteral}{'LIKE'}, \textcolor{stringliteral}{"$search%"})
198                     ->take($this->property(\textcolor{stringliteral}{'maxUserSuggestions'}))
199                     ->get();
200              
201             \textcolor{comment}{/*}
202 \textcolor{comment}{            $users = User::groups()}
203 \textcolor{comment}{                    ->wherePivot('membership\_status', '<>', UserGroup::MEMBERSHIP\_ACCEPTED )}
204 \textcolor{comment}{                    ->with('groups')}
205 \textcolor{comment}{                    ->whereHas('groups', function($query)\{}
206 \textcolor{comment}{                        $query->where('is\_active', true);}
207 \textcolor{comment}{                    \})}
208 \textcolor{comment}{                   }
209 \textcolor{comment}{                    ->get();}
210 \textcolor{comment}{            */}
211             \textcolor{comment}{// Updated list of users and other vars}
212             $this->prepareVars(null, [\textcolor{stringliteral}{'search'} => $search, \textcolor{stringliteral}{'users'}=>$users]);            
213         \}
214     \}    
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
components/Group\+Form\+Creation.\+php\end{DoxyCompactItemize}
