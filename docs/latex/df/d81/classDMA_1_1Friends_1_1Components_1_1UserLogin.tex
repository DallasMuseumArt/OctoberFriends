\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin}{}\section{D\+M\+A\textbackslash{}Friends\textbackslash{}Components\textbackslash{}User\+Login Class Reference}
\label{classDMA_1_1Friends_1_1Components_1_1UserLogin}\index{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login@{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login}}
Inheritance diagram for D\+M\+A\textbackslash{}Friends\textbackslash{}Components\textbackslash{}User\+Login\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{df/d81/classDMA_1_1Friends_1_1Components_1_1UserLogin}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_acdfe6ac44ada2b3cfd131e0529e939bf}{}{\bfseries component\+Details} ()\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_acdfe6ac44ada2b3cfd131e0529e939bf}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_aed0e2d9c2a568fa59e91b24d2c920639}{}{\bfseries define\+Properties} ()\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_aed0e2d9c2a568fa59e91b24d2c920639}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_af4bf91673455e94e2af6807fcc7535cf}{}{\bfseries get\+Redirect\+Options} ()\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_af4bf91673455e94e2af6807fcc7535cf}

\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a0820819b4447a5279432463d42d7a4e6}{}{\bfseries on\+Run} ()\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a0820819b4447a5279432463d42d7a4e6}

\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_ae62d795e0eb073ab1e9b6e74425a04a7}{on\+Login} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a9f64120e2a98aca7bb6ad628d9a72844}{on\+User\+Login} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a232f43a38ed3fcdb7ebf6c774b031496}{on\+Forgot\+Password} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a61008348cecd24a9b01b20aeebc04b4b}{on\+Register} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a49b72261eed4c7750ca24e23ebecc945}{on\+Available\+User} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_adb35ec3a5460d1a197337104a54b55b1}{on\+Register\+Submit} ()
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5390d4ee17957bf8df7209892cfdadb0}{}{\bfseries get\+Avatars} ()\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5390d4ee17957bf8df7209892cfdadb0}

\item 
\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5845beab2a28f2a742da61b23a680eda}{make\+Partial} (\$partial, \$params=\mbox{[}$\,$\mbox{]}, \$throw\+Exception=true)
\item 
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a58168b62fe7af6d5c5a70c3cd83c9707}{}{\bfseries load\+Assets} ()\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a58168b62fe7af6d5c5a70c3cd83c9707}

\end{DoxyCompactItemize}
\subsection*{Static Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a88372af498e2b89424acdab1537b0210}{get\+Theme\+Partials\+Dir} ()
\item 
static \hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a2a61aaf01e9349803794f8fa7a743175}{get\+Theme\+Dir} ()
\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a2a61aaf01e9349803794f8fa7a743175}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!get\+Theme\+Dir@{get\+Theme\+Dir}}
\index{get\+Theme\+Dir@{get\+Theme\+Dir}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{get\+Theme\+Dir}]{\setlength{\rightskip}{0pt plus 5cm}static D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::get\+Theme\+Dir (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a2a61aaf01e9349803794f8fa7a743175}
Get the path to the theme\textquotesingle{}s partials

\begin{DoxyReturn}{Returns}
string \$path 
\end{DoxyReturn}

\begin{DoxyCode}
325     \{
326         $theme = Theme::getActiveTheme();
327         \textcolor{keywordflow}{return} $theme->getPath();
328     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a88372af498e2b89424acdab1537b0210}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!get\+Theme\+Partials\+Dir@{get\+Theme\+Partials\+Dir}}
\index{get\+Theme\+Partials\+Dir@{get\+Theme\+Partials\+Dir}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{get\+Theme\+Partials\+Dir}]{\setlength{\rightskip}{0pt plus 5cm}static D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::get\+Theme\+Partials\+Dir (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a88372af498e2b89424acdab1537b0210}
Get the path to the theme\textquotesingle{}s partials

\begin{DoxyReturn}{Returns}
string \$path 
\end{DoxyReturn}

\begin{DoxyCode}
315     \{
316         \textcolor{keywordflow}{return} self::getThemeDir() . \textcolor{stringliteral}{'/partials/'};
317     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5845beab2a28f2a742da61b23a680eda}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!make\+Partial@{make\+Partial}}
\index{make\+Partial@{make\+Partial}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{make\+Partial}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::make\+Partial (
\begin{DoxyParamCaption}
\item[{}]{\$partial, }
\item[{}]{\$params = {\ttfamily \mbox{[}\mbox{]}}, }
\item[{}]{\$throw\+Exception = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5845beab2a28f2a742da61b23a680eda}
Implementation of View\+Maker-\/$>$make\+Partial that renders a partial in a modal dialog and can accept a partial from the active theme


\begin{DoxyParams}[1]{Parameters}
string & {\em \$partial} & Name of the partial to be rendered. The partial must reside in the active theme\textquotesingle{}s \char`\"{}partials\char`\"{} directory\\
\hline
array & {\em \$params} & An array of parameters to be passed to make\+Partial. See Backend for details\\
\hline
boolean & {\em \$throw\+Exception} & if true an exception will be thrown if the partial is not available\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string \$content A rendered partial 
\end{DoxyReturn}

\begin{DoxyCode}
291     \{   
292         $partialsDir = self::getThemePartialsDir();
293         $partialPath = $partialsDir . $partial . \textcolor{stringliteral}{'.htm'};
294 
295         \textcolor{keywordflow}{if} (!File::isFile($partialPath)) \{
296             $partialPath = $this->getViewPath($partial) . \textcolor{stringliteral}{'.htm'};
297         \}
298 
299         \textcolor{keywordflow}{if} (!File::isFile($partialPath)) \{
300             \textcolor{keywordflow}{if} ($throwException)
301                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} \hyperlink{namespaceSystemException}{SystemException}(Lang::get(\textcolor{stringliteral}{'backend::lang.partial.not\_found'}, [\textcolor{stringliteral}{'
      name'} => $partialPath]));
302             \textcolor{keywordflow}{else}
303                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
304         \}   
305 
306         \textcolor{keywordflow}{return} $this->makeFileContents($partialPath, $params);
307     \}   
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a49b72261eed4c7750ca24e23ebecc945}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!on\+Available\+User@{on\+Available\+User}}
\index{on\+Available\+User@{on\+Available\+User}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{on\+Available\+User}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::on\+Available\+User (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a49b72261eed4c7750ca24e23ebecc945}
Verify if the given user mail is not already register 
\begin{DoxyCode}
150     \{
151         $email = post(\textcolor{stringliteral}{'email'});
152         $data = [\textcolor{stringliteral}{'available'} =>  \textcolor{keyword}{true}];
153         \textcolor{keywordflow}{if} ( User::where(\textcolor{stringliteral}{'email'}, $email)->count() > 0 ) \{
154             $data[\textcolor{stringliteral}{'available'}] = \textcolor{keyword}{false};
155         \}
156         \textcolor{keywordflow}{return} $data;
157     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a232f43a38ed3fcdb7ebf6c774b031496}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!on\+Forgot\+Password@{on\+Forgot\+Password}}
\index{on\+Forgot\+Password@{on\+Forgot\+Password}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{on\+Forgot\+Password}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::on\+Forgot\+Password (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a232f43a38ed3fcdb7ebf6c774b031496}
Render the registration form. Override the partial \char`\"{}register-\/form\char`\"{} in the active theme to customize the registration form 
\begin{DoxyCode}
121     \{    
122         \textcolor{keywordflow}{return} $this->renderPartial(\textcolor{stringliteral}{'@modalDisplay'}, [
123             \textcolor{stringliteral}{'title'}     => Lang::get(\textcolor{stringliteral}{'dma.friends::lang.userLogin.forgotPasswordTitle'}),
124             \textcolor{stringliteral}{'content'}   => $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5845beab2a28f2a742da61b23a680eda}{makePartial}(\textcolor{stringliteral}{'forgot-password'}),
125         ]);
126     \}    
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_ae62d795e0eb073ab1e9b6e74425a04a7}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!on\+Login@{on\+Login}}
\index{on\+Login@{on\+Login}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{on\+Login}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::on\+Login (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_ae62d795e0eb073ab1e9b6e74425a04a7}
Render the login form. Override the partial \char`\"{}login-\/form\char`\"{} in the active theme to customize the login form 
\begin{DoxyCode}
62     \{        
63         \textcolor{keywordflow}{return} $this->renderPartial(\textcolor{stringliteral}{'@modalDisplay'}, [
64             \textcolor{stringliteral}{'title'}     => Lang::get(\textcolor{stringliteral}{'dma.friends::lang.userLogin.loginTitle'}),
65             \textcolor{stringliteral}{'content'}   => $this->\hyperlink{classDMA_1_1Friends_1_1Components_1_1UserLogin_a5845beab2a28f2a742da61b23a680eda}{makePartial}(\textcolor{stringliteral}{'login-form'}),
66         ]);
67     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a61008348cecd24a9b01b20aeebc04b4b}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!on\+Register@{on\+Register}}
\index{on\+Register@{on\+Register}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{on\+Register}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::on\+Register (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a61008348cecd24a9b01b20aeebc04b4b}
Render the registration form. Override the partial \char`\"{}register-\/form\char`\"{} in the active theme to customize the registration form 
\begin{DoxyCode}
133     \{
134         $options = \hyperlink{classDMA_1_1Friends_1_1Models_1_1Usermeta_a1acccb846d0ba68fcc9694cc0b1c4006}{Usermeta::getOptions}();
135 
136         \textcolor{keywordflow}{return} $this->renderPartial(\textcolor{stringliteral}{'@modalDisplay'}, [
137             \textcolor{stringliteral}{'title'}     => Lang::get(\textcolor{stringliteral}{'dma.friends::lang.userLogin.registerTitle'}),
138             \textcolor{stringliteral}{'content'}   => $this->renderPartial(\textcolor{stringliteral}{'register-form'}, [ 
139                 \textcolor{stringliteral}{'options'}   => $options, 
140                 \textcolor{stringliteral}{'avatars'}   => $this->getAvatars(),
141                 \textcolor{stringliteral}{'terms'}     => $this->renderPartial(\textcolor{stringliteral}{'terms-and-conditions.htm'}),
142             ]),
143         ]);
144     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_adb35ec3a5460d1a197337104a54b55b1}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!on\+Register\+Submit@{on\+Register\+Submit}}
\index{on\+Register\+Submit@{on\+Register\+Submit}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{on\+Register\+Submit}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::on\+Register\+Submit (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_adb35ec3a5460d1a197337104a54b55b1}
Submit handler for registration 
\begin{DoxyCode}
163     \{
164         $data = post();
165 
166         $rules = [
167             \textcolor{stringliteral}{'first\_name'}            => \textcolor{stringliteral}{'required|min:2'},
168             \textcolor{stringliteral}{'last\_name'}             => \textcolor{stringliteral}{'required|min:2'},
169             \textcolor{comment}{//'username'              => 'required|min:6',}
170             \textcolor{stringliteral}{'email'}                 => \textcolor{stringliteral}{'required|email|between:2,64'},
171             \textcolor{stringliteral}{'password'}              => \textcolor{stringliteral}{'required|min:6'},
172             \textcolor{stringliteral}{'password\_confirmation'} => \textcolor{stringliteral}{'required|min:6'},
173         ];
174 
175         $validation = Validator::make($data, $rules);
176         \textcolor{keywordflow}{if} ($validation->fails())
177             \textcolor{keywordflow}{throw} \textcolor{keyword}{new} \hyperlink{namespaceValidationException}{ValidationException}($validation);
178 
179         \textcolor{comment}{/*}
180 \textcolor{comment}{         * Register user}
181 \textcolor{comment}{         */}
182         $requireActivation = UserSettings::get(\textcolor{stringliteral}{'require\_activation'}, \textcolor{keyword}{true});
183         $automaticActivation = UserSettings::get(\textcolor{stringliteral}{'activate\_mode'}) == UserSettings::ACTIVATE\_AUTO;
184         $userActivation = UserSettings::get(\textcolor{stringliteral}{'activate\_mode'}) == UserSettings::ACTIVATE\_USER;
185 
186         \textcolor{comment}{// Split the data into whats required for the user and usermeta models}
187         $userData = [
188             \textcolor{stringliteral}{'name'}                  => $data[\textcolor{stringliteral}{'first\_name'}] . \textcolor{charliteral}{' '} . $data[\textcolor{stringliteral}{'last\_name'}],
189             \textcolor{stringliteral}{'password'}              => $data[\textcolor{stringliteral}{'password'}],
190             \textcolor{stringliteral}{'password\_confirmation'} => $data[\textcolor{stringliteral}{'password\_confirmation'}],
191             \textcolor{stringliteral}{'email'}                 => $data[\textcolor{stringliteral}{'email'}],
192             \textcolor{stringliteral}{'street\_addr'}           => $data[\textcolor{stringliteral}{'street\_addr'}],
193             \textcolor{stringliteral}{'city'}                  => $data[\textcolor{stringliteral}{'city'}],
194             \textcolor{stringliteral}{'state'}                 => $data[\textcolor{stringliteral}{'state'}],
195             \textcolor{stringliteral}{'zip'}                   => $data[\textcolor{stringliteral}{'zip'}],
196             \textcolor{stringliteral}{'phone'}                 => UserExtend::parsePhone($data[\textcolor{stringliteral}{'phone'}]),
197         ];
198 
199         $user = Auth::register($userData, $automaticActivation);
200 
201         $birth\_date = $data[\textcolor{stringliteral}{'birthday'}][\textcolor{stringliteral}{'year'}] 
202             . \textcolor{charliteral}{'-'} .  sprintf(\textcolor{stringliteral}{"%02s"}, $data[\textcolor{stringliteral}{'birthday'}][\textcolor{stringliteral}{'month'}]) 
203             . \textcolor{charliteral}{'-'} .  sprintf(\textcolor{stringliteral}{"%02s"}, $data[\textcolor{stringliteral}{'birthday'}][\textcolor{stringliteral}{'day'}])
204             . \textcolor{stringliteral}{' 00:00:00'};
205 
206         \textcolor{comment}{// Save user metadata}
207         $usermeta = \textcolor{keyword}{new} Usermeta;
208         $usermeta->first\_name       = $data[\textcolor{stringliteral}{'first\_name'}];
209         $usermeta->last\_name        = $data[\textcolor{stringliteral}{'last\_name'}];
210         $usermeta->birth\_date       = $birth\_date;
211         $usermeta->email\_optin      = isset($data[\textcolor{stringliteral}{'email\_optin'}]) ? $data[\textcolor{stringliteral}{'email\_optin'}] : \textcolor{keyword}{false};
212 
213         \textcolor{comment}{// Uncomment to enable demographics in registration form;}
214         \textcolor{comment}{// $usermeta->gender           = $data['gender'];}
215         \textcolor{comment}{// $usermeta->race             = $data['race'];}
216         \textcolor{comment}{// $usermeta->household\_income = $data['household\_income'];}
217         \textcolor{comment}{// $usermeta->household\_size   = $data['household\_size'];}
218         \textcolor{comment}{// $usermeta->education        = $data['education'];}
219 
220         $user->metadata()->save($usermeta);
221 
222         \textcolor{keywordflow}{if} (isset($data[\textcolor{stringliteral}{'avatar'}])) \{
223             UserExtend::uploadAvatar($user, $data[\textcolor{stringliteral}{'avatar'}]);
224         \}
225         \textcolor{comment}{/*}
226 \textcolor{comment}{         * Activation is by the user, send the email}
227 \textcolor{comment}{         */}
228         \textcolor{keywordflow}{if} ($userActivation) \{
229             $this->sendActivationEmail($user);
230         \}
231 
232         \textcolor{comment}{/*}
233 \textcolor{comment}{         * Automatically activated or not required, log the user in}
234 \textcolor{comment}{         */}
235         \textcolor{keywordflow}{if} ($automaticActivation || !$requireActivation) \{
236             Auth::login($user);
237         \}
238 
239         \textcolor{comment}{/*}
240 \textcolor{comment}{         * Fire event that user has registered}
241 \textcolor{comment}{         */}
242         Event::fire(\textcolor{stringliteral}{'auth.register'}, [$user]);
243 
244         \textcolor{comment}{/*}
245 \textcolor{comment}{         * Redirect to the intended page after successful sign in}
246 \textcolor{comment}{         */}
247         $redirectUrl = $this->pageUrl($this->property(\textcolor{stringliteral}{'redirect'}));
248 
249         \textcolor{keywordflow}{if} ($redirectUrl = post(\textcolor{stringliteral}{'redirect'}, $redirectUrl))
250             \textcolor{keywordflow}{return} Redirect::intended($redirectUrl);
251     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Components_1_1UserLogin_a9f64120e2a98aca7bb6ad628d9a72844}{}\index{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}!on\+User\+Login@{on\+User\+Login}}
\index{on\+User\+Login@{on\+User\+Login}!D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login@{D\+M\+A\+::\+Friends\+::\+Components\+::\+User\+Login}}
\subsubsection[{on\+User\+Login}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Components\textbackslash{}\+User\+Login\+::on\+User\+Login (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classDMA_1_1Friends_1_1Components_1_1UserLogin_a9f64120e2a98aca7bb6ad628d9a72844}
Submit handler for the login form 
\begin{DoxyCode}
73     \{
74         \textcolor{keywordflow}{try} \{
75 
76             \textcolor{comment}{// Update wordpress passwords if necessary}
77             WordpressAuth::verifyFromEmail(post(\textcolor{stringliteral}{'email'}), post(\textcolor{stringliteral}{'password'}));
78 
79             $data = [
80                 \textcolor{stringliteral}{'login'}     => post(\textcolor{stringliteral}{'login'}),
81                 \textcolor{stringliteral}{'password'}  => post(\textcolor{stringliteral}{'password'}),
82             ];
83 
84             \hyperlink{classDMA_1_1Friends_1_1Classes_1_1AuthManager_a22836fc33b7788f7b41bbb253c6f58af}{AuthManager::auth}($data);
85             
86             $redirectUrl = $this->pageUrl($this->property(\textcolor{stringliteral}{'redirect'}));
87     
88             \textcolor{keywordflow}{if} ($redirectUrl = post(\textcolor{stringliteral}{'redirect'}, $redirectUrl))
89                 \textcolor{keywordflow}{return} Redirect::intended($redirectUrl);
90         
91         
92         \} \textcolor{keywordflow}{catch}(\(\backslash\)\hyperlink{namespaceException}{Exception} $e) \{
93             \textcolor{comment}{// Catch all exceptions producced by RainLab User or DMA authentication}
94             \textcolor{comment}{// and update error block message using OctoberCMS Ajax framework}
95             $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.userLogin.failCredentials'});
96                        
97             \textcolor{comment}{// Bit doggy but if the exception message contains the login}
98             \textcolor{comment}{// is because the account is been suspend or banned by RainLab user plugin}
99             \textcolor{comment}{// This usually because the user has atent to loging multiple times with a }
100             \textcolor{comment}{// wrong password.}
101             \textcolor{keywordflow}{if}(preg\_match(\textcolor{stringliteral}{"/\(\backslash\)["} . $data[\textcolor{stringliteral}{'login'}] . \textcolor{stringliteral}{"\(\backslash\)]/"}, $e->getMessage()))\{ 
102                 $message = $message = Lang::get(\textcolor{stringliteral}{'dma.friends::lang.userLogin.throttleUser'}, $data);
103             \}
104             
105             \textcolor{comment}{// Send to log the authentication exception.}
106             \(\backslash\)Log::debug($e);
107             
108             \textcolor{keywordflow}{return} [
109                \textcolor{stringliteral}{'.modal-content #errorBlock'} => $message
110             ];
111       
112         \}
113         
114     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
components/User\+Login.\+php\end{DoxyCompactItemize}
