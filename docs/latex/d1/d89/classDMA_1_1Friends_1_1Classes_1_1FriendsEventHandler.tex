\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler}{\section{D\+M\+A\textbackslash{}Friends\textbackslash{}Classes\textbackslash{}Friends\+Event\+Handler Class Reference}
\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler}\index{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Friends\+Event\+Handler@{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Friends\+Event\+Handler}}
}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a6467365017b9d494122c8ded41a9a406}{on\+Activity\+Completed} (\$activity, \$user)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aa13c2568369d06c2a0ca1c96f099ff09}{on\+Badge\+Completed} (\$badge, \$user)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aeb8499a09334c87311a7f5840c43685a}{on\+Reward\+Redeemed} (\$reward, \$user)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a3a99cae5eaa37efa395ef4fe8eb30c11}{on\+Step\+Completed} (\$step, \$user)
\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a480d5807466962402ccc13260cfb0930}{{\bfseries on\+Auth\+Login} (\$event)}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a480d5807466962402ccc13260cfb0930}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aa1d57544bd13c8acf91a3f4e3bf150a5}{{\bfseries on\+Auth\+Register} (\$user)}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aa1d57544bd13c8acf91a3f4e3bf150a5}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_ac411d3e487b4a16bd3116f3abf1e38a7}{{\bfseries on\+Notifications\+Ready} ()}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_ac411d3e487b4a16bd3116f3abf1e38a7}

\item 
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a92cad97622be6dd1ed477dcc05d81074}{{\bfseries subscribe} (\$events)}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a92cad97622be6dd1ed477dcc05d81074}

\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a6467365017b9d494122c8ded41a9a406}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}!on\+Activity\+Completed@{on\+Activity\+Completed}}
\index{on\+Activity\+Completed@{on\+Activity\+Completed}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}}
\subsubsection[{on\+Activity\+Completed}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Friends\+Event\+Handler\+::on\+Activity\+Completed (
\begin{DoxyParamCaption}
\item[{}]{\$activity, }
\item[{}]{\$user}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a6467365017b9d494122c8ded41a9a406}
Handle the dma.\+friends.\+activity.\+completed event 
\begin{DoxyParams}[1]{Parameters}
Activity & {\em \$activity} & The activity model that has just been completed \\
\hline
User & {\em \$user} & The user that completed the activity \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
37     \{   
38     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aa13c2568369d06c2a0ca1c96f099ff09}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}!on\+Badge\+Completed@{on\+Badge\+Completed}}
\index{on\+Badge\+Completed@{on\+Badge\+Completed}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}}
\subsubsection[{on\+Badge\+Completed}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Friends\+Event\+Handler\+::on\+Badge\+Completed (
\begin{DoxyParamCaption}
\item[{}]{\$badge, }
\item[{}]{\$user}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aa13c2568369d06c2a0ca1c96f099ff09}
Handle the dma.\+friends.\+badge.\+completed event 
\begin{DoxyParams}[1]{Parameters}
Badge & {\em \$badge} & The badge model that has just been completed \\
\hline
User & {\em \$user} & The user that completed the badge \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
48     \{
49         $data = [
50             \textcolor{stringliteral}{'badge'} => $badge,
51             \textcolor{stringliteral}{'user'}  => $user,
52         ];
53 
54         Mail::send(\textcolor{stringliteral}{'dma.friends::mail.badge'}, $data, \textcolor{keyword}{function}($message) use ($user)
55         \{
56             $message->to($user->email, $user->full\_name);
57         \});
58     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aeb8499a09334c87311a7f5840c43685a}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}!on\+Reward\+Redeemed@{on\+Reward\+Redeemed}}
\index{on\+Reward\+Redeemed@{on\+Reward\+Redeemed}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}}
\subsubsection[{on\+Reward\+Redeemed}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Friends\+Event\+Handler\+::on\+Reward\+Redeemed (
\begin{DoxyParamCaption}
\item[{}]{\$reward, }
\item[{}]{\$user}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_aeb8499a09334c87311a7f5840c43685a}
Handle the dma.\+friends.\+reward.\+redeemed event 
\begin{DoxyParams}[1]{Parameters}
Reward & {\em \$reward} & The reward model that has just been redeemed \\
\hline
User & {\em \$user} & The user that redeemed the reward \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
68     \{   
69         $data = [
70             \textcolor{stringliteral}{'reward'}    => $reward,
71             \textcolor{stringliteral}{'user'}      => $user,
72         ];
73 
74         \textcolor{comment}{// Send an email to the user that redeemed the reward}
75         \textcolor{keywordflow}{if} ($reward->enable\_email) \{ 
76             Mail::send($reward->email\_template, $data, \textcolor{keyword}{function}($message) use ($reward, $user)
77             \{
78                 $message->to($user->email, $user->full\_name);
79             \});
80         \}
81 
82         \textcolor{keywordflow}{if} ($reward->enable\_admin\_email) \{
83             Mail::send($reward->admin\_email\_template, $data, \textcolor{keyword}{function}($message) use ($reward, $user)
84             \{
85                 \textcolor{comment}{// If a group is configured email those users}
86                 \textcolor{keywordflow}{if} (!empty($reward->admin\_email\_group)) \{
87                     $group = UserGroup::find($reward->admin\_email\_group);
88 
89                     foreach($group->users as $user) \{
90                         $message->to($user->email, $user->first\_name . \textcolor{stringliteral}{' '} . $user->last\_name);
91                     \}
92                 \}
93 
94                 \textcolor{comment}{// If an individual email is configured email that person}
95                 \textcolor{keywordflow}{if} (!empty($reward->admin\_email\_address)) \{
96                     $message->to($reward->admin\_email\_address, \textcolor{stringliteral}{'Anonymous'});
97                 \}
98             \});
99         \}
100 
101         \textcolor{comment}{// Print the reward if user is at a kiosk}
102         $location = LocationManager::getLocation();
103         \textcolor{keywordflow}{if} ($location) \{
104             $printManager = \textcolor{keyword}{new} PrintManager($location, $user);
105             $printManager->printCoupon($reward);
106         \}
107 
108     \}   
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a3a99cae5eaa37efa395ef4fe8eb30c11}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}!on\+Step\+Completed@{on\+Step\+Completed}}
\index{on\+Step\+Completed@{on\+Step\+Completed}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Friends\+Event\+Handler}}
\subsubsection[{on\+Step\+Completed}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Friends\+Event\+Handler\+::on\+Step\+Completed (
\begin{DoxyParamCaption}
\item[{}]{\$step, }
\item[{}]{\$user}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1FriendsEventHandler_a3a99cae5eaa37efa395ef4fe8eb30c11}
Handle the dma.\+friends.\+step.\+completed event 
\begin{DoxyParams}[1]{Parameters}
Step & {\em \$step} & The step model that has just been completed \\
\hline
User & {\em \$user} & The user that completed the step \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
118     \{   
119         
120     \}   
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
classes/Friends\+Event\+Handler.\+php\end{DoxyCompactItemize}
