\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter}{\section{D\+M\+A\textbackslash{}Friends\textbackslash{}Classes\textbackslash{}Notifications\textbackslash{}Channels\textbackslash{}Channel\+Twitter Class Reference}
\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter}\index{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter@{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter}}
}
Inheritance diagram for D\+M\+A\textbackslash{}Friends\textbackslash{}Classes\textbackslash{}Notifications\textbackslash{}Channels\textbackslash{}Channel\+Twitter\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.546961cm]{dd/d13/classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a25df1af4306d6282d23082c17054aeeb}{get\+Details} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a6e5f6e1abe8d6b7c9d0442c3f2560b44}{config\+Channel} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a51e362d79b1978fa683709e2794cb6d5}{setting\+Fields} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a14439c4b83e7d0e0dd0437f141a998e5}{send} (\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1NotificationMessage}{Notification\+Message} \$message)
\item 
\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a3b453a0cb63ace5be8f33763949af5b1}{read} ()
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a03b0a9d5016d8e69105276db8b32537f}{get\+Key} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Channel}{Channel} for sending Directed Messages notifications via Twitter. This channel is experimental. \begin{DoxyAuthor}{Author}
Carlos Arroyo 
\end{DoxyAuthor}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a6e5f6e1abe8d6b7c9d0442c3f2560b44}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}!config\+Channel@{config\+Channel}}
\index{config\+Channel@{config\+Channel}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}}
\subsubsection[{config\+Channel}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter\+::config\+Channel (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a6e5f6e1abe8d6b7c9d0442c3f2560b44}
Load channel configurations. \begin{DoxySeeAlso}{See also}
\+::config\+Channel() 
\end{DoxySeeAlso}


Implements \hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Channel_a63df08fbca39589ea32f729d9485cb37}{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel}.


\begin{DoxyCode}
43     \{
44         $this->settings = array(
45             \textcolor{stringliteral}{'oauth\_access\_token'}          => Settings::get(\textcolor{stringliteral}{'twitter\_access\_token'}),
46             \textcolor{stringliteral}{'oauth\_access\_token\_secret'}   => Settings::get(\textcolor{stringliteral}{'twitter\_access\_token\_secret'}),
47             \textcolor{stringliteral}{'consumer\_key'}                => Settings::get(\textcolor{stringliteral}{'twitter\_consumer\_key'}),
48             \textcolor{stringliteral}{'consumer\_secret'}             => Settings::get(\textcolor{stringliteral}{'twitter\_consumer\_key\_secret'}),
49         );
50 
51     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a25df1af4306d6282d23082c17054aeeb}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}!get\+Details@{get\+Details}}
\index{get\+Details@{get\+Details}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}}
\subsubsection[{get\+Details}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter\+::get\+Details (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a25df1af4306d6282d23082c17054aeeb}
Return details of the channel. Manly used in the Backend interface.

\begin{DoxyReturn}{Returns}
array
\end{DoxyReturn}
eg. \mbox{[} 'name' =$>$ 'Kiosk', 'description' =$>$ 'Store notification in the database. So they can be read in a Kiosk or a Web interface.' \mbox{]} \begin{DoxySeeAlso}{See also}
\+::get\+Details() 
\end{DoxySeeAlso}


Implements \hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Channel_a78e25e374398ef085f37fb8d22203bdb}{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel}.


\begin{DoxyCode}
31     \{
32         \textcolor{keywordflow}{return} [
33                 \textcolor{stringliteral}{'name'}           => \textcolor{stringliteral}{'Twitter'},
34                 \textcolor{stringliteral}{'description'}    => \textcolor{stringliteral}{'Send notifications via Twitter. (Experimental)'}
35         ];
36     \}   
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a03b0a9d5016d8e69105276db8b32537f}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}!get\+Key@{get\+Key}}
\index{get\+Key@{get\+Key}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}}
\subsubsection[{get\+Key}]{\setlength{\rightskip}{0pt plus 5cm}static D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter\+::get\+Key (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a03b0a9d5016d8e69105276db8b32537f}
Used to identify view per channel.

\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}


Implements \hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Channel_a53b32a2d7c27477655a9d4b87164c203}{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel}.


\begin{DoxyCode}
22     \{
23         \textcolor{keywordflow}{return} \textcolor{stringliteral}{'twitter'};
24     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a3b453a0cb63ace5be8f33763949af5b1}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}!read@{read}}
\index{read@{read}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}}
\subsubsection[{read}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter\+::read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a3b453a0cb63ace5be8f33763949af5b1}
Implemented specific logic for each channel for retriving incoming data through the channel.

\begin{DoxyReturn}{Returns}
array Array of \hyperlink{namespaceDMA}{D\+M\+A}
\end{DoxyReturn}
 \begin{DoxySeeAlso}{See also}
\+::read\+Channel() 
\end{DoxySeeAlso}


Implements \hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Listenable_aebc4dc5c57897e075a719e911a590d6e}{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Listenable}.


\begin{DoxyCode}
141     \{
142         \textcolor{comment}{//https://api.twitter.com/1.1/search/tweets.json}
143         $url = \textcolor{stringliteral}{'https://api.twitter.com/1.1/search/tweets.json'};
144         $requestMethod = \textcolor{stringliteral}{'GET'};
145 
146         $getfield = \textcolor{stringliteral}{'?q='} . Settings::get(\textcolor{stringliteral}{'twitter\_search\_hashtag'});
147         $maxId = Null;
148         If( $sinceId = Settings::set(\textcolor{stringliteral}{'twitter\_since\_id'}) &&
149             $maxId   = Settings::get(\textcolor{stringliteral}{'twitter\_max\_id'}) )\{
150             $getfield = $getfield . \textcolor{stringliteral}{'&since\_id='} . $sinceId;
151             $getfield = $getfield . \textcolor{stringliteral}{'&max\_id='} . $maxId;
152         \}
153 
154         $client = $this->getClient();
155         $response = $client->setGetfield($getfield)
156             ->buildOauth($url, $requestMethod)
157             ->performRequest();
158 
159         \textcolor{comment}{// Convert results to php objects}
160         $result = json\_decode($response);
161 
162 
163         \textcolor{comment}{// Convert tweets into messages}
164         $tweetIds = [];
165         $messages = [];
166         \textcolor{keywordflow}{foreach}($result->statuses as $tweet)\{
167 
168             $tweetId = $tweet->id;
169             \textcolor{comment}{// Because max\_id is also includes the tweet that we have already}
170             \textcolor{comment}{// processed if max\_id is present we remove this tweet from the messages.}
171             \textcolor{keywordflow}{if} ($tweetId != $maxId)\{
172                $tweetIds[] = $tweet->id;
173 
174                $msg = \textcolor{keyword}{new} IncomingMessage($this->\hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a03b0a9d5016d8e69105276db8b32537f}{getKey}());
175                $msg->from($tweet->user->id, $tweet->user->name);
176                $msg->setContent($tweet->text);
177 
178                $messages[]=$msg;
179             \}
180 
181         \}
182 
183         \textcolor{comment}{// Get max\_id and since\_id}
184         \textcolor{comment}{// Further information on this Twitter parameters go to}
185         \textcolor{comment}{// https://dev.twitter.com/rest/public/timelines}
186         Settings::set(\textcolor{stringliteral}{'twitter\_max\_id'},   min($tweetIds));
187         Settings::set(\textcolor{stringliteral}{'twitter\_since\_id'}, max($tweetIds));
188 
189         \textcolor{keywordflow}{return} $messages;
190 
191     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a14439c4b83e7d0e0dd0437f141a998e5}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}!send@{send}}
\index{send@{send}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}}
\subsubsection[{send}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter\+::send (
\begin{DoxyParamCaption}
\item[{{\bf Notification\+Message}}]{\$message}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a14439c4b83e7d0e0dd0437f141a998e5}
Use \hyperlink{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1NotificationMessage}{Notification\+Message} set\+Data method to add user twitter\+Handle Send notifiation 
\begin{DoxyParams}{Parameters}
{\em \hyperlink{namespaceDMA}{D\+M\+A}} & Friends \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
boolean
\end{DoxyReturn}
 \begin{DoxySeeAlso}{See also}
\+::send() 
\end{DoxySeeAlso}


Implements \hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Channel_a8138dfd93ce9617213637789e793f4c7}{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel}.


\begin{DoxyCode}
114     \{
115         \textcolor{comment}{// TODO : add validation to control the size of the message.}
116         $data          = $message->getData();
117         $txt           = $message->getContent();
118         $screen\_name   = $message->getTo();
119 
120         $url = \textcolor{stringliteral}{'https://api.twitter.com/1.1/direct\_messages/new.json'};
121         $postfields = [
122            \textcolor{stringliteral}{'screen\_name'} => $screen\_name,
123            \textcolor{stringliteral}{'text'} => $txt
124         ];
125         $requestMethod = \textcolor{stringliteral}{'POST'};
126 
127         $client = $this->getClient();
128         $response = $client->setPostfields($postfields)
129                             ->buildOauth($url, $requestMethod)
130                             ->performRequest();
131 
132 
133         echo($response);
134     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a51e362d79b1978fa683709e2794cb6d5}{\index{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}!setting\+Fields@{setting\+Fields}}
\index{setting\+Fields@{setting\+Fields}!D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter@{D\+M\+A\+::\+Friends\+::\+Classes\+::\+Notifications\+::\+Channels\+::\+Channel\+Twitter}}
\subsubsection[{setting\+Fields}]{\setlength{\rightskip}{0pt plus 5cm}D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel\+Twitter\+::setting\+Fields (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1ChannelTwitter_a51e362d79b1978fa683709e2794cb6d5}
Return settings fields for this channel. For futher information go to \href{http://octobercms.com/docs/plugin/settings#database-settings}{\tt http\+://octobercms.\+com/docs/plugin/settings\#database-\/settings}

\begin{DoxyReturn}{Returns}
array
\end{DoxyReturn}
 \begin{DoxySeeAlso}{See also}
\+::setting\+Fields() 
\end{DoxySeeAlso}


Implements \hyperlink{interfaceDMA_1_1Friends_1_1Classes_1_1Notifications_1_1Channels_1_1Channel_aa473115fa58a6fa5f57a9069f23dd771}{D\+M\+A\textbackslash{}\+Friends\textbackslash{}\+Classes\textbackslash{}\+Notifications\textbackslash{}\+Channels\textbackslash{}\+Channel}.


\begin{DoxyCode}
71     \{
72         \textcolor{keywordflow}{return} [
73             \textcolor{stringliteral}{'twitter\_access\_token'} => [
74                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Access token'},
75                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'}
76             ],
77             \textcolor{stringliteral}{'twitter\_access\_token\_secret'} => [
78                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Access token secret'},
79                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'}
80             ],
81             \textcolor{stringliteral}{'twitter\_consumer\_key'} => [
82                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Consumer key'},
83                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'}
84             ],
85             \textcolor{stringliteral}{'twitter\_consumer\_key\_secret'} => [
86                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Consumer key secret'},
87                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'}
88             ],
89             \textcolor{stringliteral}{'twitter\_search\_hashtag'} => [
90                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Search tweets with hashtag'},
91                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'}
92             ],
93             \textcolor{stringliteral}{'twitter\_since\_id'} => [
94                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Current Since ID'},
95                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'},
96                 \textcolor{stringliteral}{'description'} => \textcolor{stringliteral}{'This field is for tracking and debugin purposes'}
97             ],
98             \textcolor{stringliteral}{'twitter\_max\_id'} => [
99                 \textcolor{stringliteral}{'label'} => \textcolor{stringliteral}{'Current Max ID'},
100                 \textcolor{stringliteral}{'span'}  => \textcolor{stringliteral}{'auto'},
101                 \textcolor{stringliteral}{'description'} => \textcolor{stringliteral}{'This field is for tracking and debugin purposes'}
102             ]
103 
104         ];
105 
106     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
classes/notifications/channels/Channel\+Twitter.\+php\end{DoxyCompactItemize}
