\hypertarget{classDMA_1_1Friends_1_1Wordpress_1_1User}{\section{D\-M\-A\textbackslash{}Friends\textbackslash{}Wordpress\textbackslash{}User Class Reference}
\label{classDMA_1_1Friends_1_1Wordpress_1_1User}\index{D\-M\-A\textbackslash{}\-Friends\textbackslash{}\-Wordpress\textbackslash{}\-User@{D\-M\-A\textbackslash{}\-Friends\textbackslash{}\-Wordpress\textbackslash{}\-User}}
}
Inheritance diagram for D\-M\-A\textbackslash{}Friends\textbackslash{}Wordpress\textbackslash{}User\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{dd/d73/classDMA_1_1Friends_1_1Wordpress_1_1User}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDMA_1_1Friends_1_1Wordpress_1_1User_ab33f393b12ecbd1a7a274a041006348f}{{\bfseries import} (\$limit=0)}\label{classDMA_1_1Friends_1_1Wordpress_1_1User_ab33f393b12ecbd1a7a274a041006348f}

\item 
\hyperlink{classDMA_1_1Friends_1_1Wordpress_1_1User_a9664b94f73cb6ed82746b94d9bdac91b}{update\-Existing\-Users} ()
\item 
\hyperlink{classDMA_1_1Friends_1_1Wordpress_1_1User_aa2d2c2c9b82db76a0eab7af41629e011}{update\-Metadata} (October\-User \$user, \$wordpress\-Id)
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Member Function Documentation}
\hypertarget{classDMA_1_1Friends_1_1Wordpress_1_1User_a9664b94f73cb6ed82746b94d9bdac91b}{\index{D\-M\-A\-::\-Friends\-::\-Wordpress\-::\-User@{D\-M\-A\-::\-Friends\-::\-Wordpress\-::\-User}!update\-Existing\-Users@{update\-Existing\-Users}}
\index{update\-Existing\-Users@{update\-Existing\-Users}!DMA::Friends::Wordpress::User@{D\-M\-A\-::\-Friends\-::\-Wordpress\-::\-User}}
\subsubsection[{update\-Existing\-Users}]{\setlength{\rightskip}{0pt plus 5cm}D\-M\-A\textbackslash{}\-Friends\textbackslash{}\-Wordpress\textbackslash{}\-User\-::update\-Existing\-Users (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Wordpress_1_1User_a9664b94f73cb6ed82746b94d9bdac91b}
Updates the metadata from wordpress on existing users 
\begin{DoxyCode}
65     \{
66         \textcolor{keywordflow}{foreach}(OctoberUser::all() as $user) \{
67             $id = $this->db
68                 ->table(\textcolor{stringliteral}{'wp\_users'})
69                 ->select(\textcolor{stringliteral}{'ID'})
70                 ->where(\textcolor{stringliteral}{'user\_email'}, $user->email)
71                 ->first();
72 
73             $this->\hyperlink{classDMA_1_1Friends_1_1Wordpress_1_1User_aa2d2c2c9b82db76a0eab7af41629e011}{updateMetadata}($user, $id->ID);
74         \}
75     \}
\end{DoxyCode}
\hypertarget{classDMA_1_1Friends_1_1Wordpress_1_1User_aa2d2c2c9b82db76a0eab7af41629e011}{\index{D\-M\-A\-::\-Friends\-::\-Wordpress\-::\-User@{D\-M\-A\-::\-Friends\-::\-Wordpress\-::\-User}!update\-Metadata@{update\-Metadata}}
\index{update\-Metadata@{update\-Metadata}!DMA::Friends::Wordpress::User@{D\-M\-A\-::\-Friends\-::\-Wordpress\-::\-User}}
\subsubsection[{update\-Metadata}]{\setlength{\rightskip}{0pt plus 5cm}D\-M\-A\textbackslash{}\-Friends\textbackslash{}\-Wordpress\textbackslash{}\-User\-::update\-Metadata (
\begin{DoxyParamCaption}
\item[{October\-User}]{\$user, }
\item[{}]{\$wordpress\-Id}
\end{DoxyParamCaption}
)}}\label{classDMA_1_1Friends_1_1Wordpress_1_1User_aa2d2c2c9b82db76a0eab7af41629e011}
Updates and save the metadata for a user object 
\begin{DoxyCode}
81     \{
82         $metadata = $this->db
83             ->table(\textcolor{stringliteral}{'wp\_usermeta'})
84             ->where(\textcolor{stringliteral}{'user\_id'}, $wordpressId)
85             ->get();
86 
87         \textcolor{comment}{// Organize the metadata for mapping to user fields}
88         $data = [
89             \textcolor{stringliteral}{'home\_phone'}            => \textcolor{stringliteral}{''},
90             \textcolor{stringliteral}{'street\_address'}        => \textcolor{stringliteral}{''},
91             \textcolor{stringliteral}{'city'}                  => \textcolor{stringliteral}{''},
92             \textcolor{stringliteral}{'state'}                 => \textcolor{stringliteral}{''},
93             \textcolor{stringliteral}{'zip'}                   => \textcolor{stringliteral}{''},
94             \textcolor{stringliteral}{'first\_name'}            => \textcolor{stringliteral}{''},
95             \textcolor{stringliteral}{'last\_name'}             => \textcolor{stringliteral}{''},
96             \textcolor{stringliteral}{'\_badgeos\_points'}       => \textcolor{stringliteral}{''},
97             \textcolor{stringliteral}{'email\_optin'}           => \textcolor{keyword}{false},
98             \textcolor{stringliteral}{'current\_member'}        => \textcolor{keyword}{false},
99             \textcolor{stringliteral}{'current\_member\_number'} => \textcolor{stringliteral}{''},
100         ];
101 
102         \textcolor{keywordflow}{foreach}($metadata as $mdata) \{
103             $data[$mdata->meta\_key] = $mdata->meta\_value;
104         \}
105 
106         $user->phone            = $data[\textcolor{stringliteral}{'home\_phone'}];
107         $user->street\_addr      = $data[\textcolor{stringliteral}{'street\_address'}];
108         $user->city             = $data[\textcolor{stringliteral}{'city'}];
109         $user->zip              = $data[\textcolor{stringliteral}{'zip'}];
110 
111         \textcolor{comment}{// Populate state and country objects}
112         \textcolor{keywordflow}{if} (!empty($data[\textcolor{stringliteral}{'state'}])) \{
113             $state = State::where(\textcolor{stringliteral}{'code'}, strtoupper($data[\textcolor{stringliteral}{'state'}]))->first();
114             \textcolor{keywordflow}{if} (!$state) \{
115                 $state = State::where(\textcolor{stringliteral}{'name'}, $data[\textcolor{stringliteral}{'state'}])->first();
116             \}
117 
118             \textcolor{keywordflow}{if} ($state) \{
119                 $user->state()->associate($state);
120                 $user->country()->associate(Country::find($state->country\_id));
121             \}
122         \}
123 
124         $metadata                           = \textcolor{keyword}{new} Usermeta;
125         $metadata->first\_name               = $data[\textcolor{stringliteral}{'first\_name'}];
126         $metadata->last\_name                = $data[\textcolor{stringliteral}{'last\_name'}];
127         $metadata->points                   = $data[\textcolor{stringliteral}{'\_badgeos\_points'}];
128         $metadata->email\_optin              = $data[\textcolor{stringliteral}{'email\_optin'}];
129         $metadata->current\_member           = $data[\textcolor{stringliteral}{'current\_member'}];
130         $metadata->current\_member\_number    = $data[\textcolor{stringliteral}{'current\_member\_number'}];
131 
132         \textcolor{keywordflow}{try} \{
133             $user->forceSave();
134             $user->metadata()->delete();
135             $user->metadata()->save($metadata);
136         \} \textcolor{keywordflow}{catch}(Exception $e) \{
137 
138         \}
139     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
wordpress/User.\-php\end{DoxyCompactItemize}
